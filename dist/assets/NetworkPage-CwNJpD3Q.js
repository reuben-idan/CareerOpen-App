import{r as u,l as h,m as L,c as M,n as _,j as s,L as m,o as P,g as S}from"./index-CAXHRMTp.js";import{E as $}from"./ErrorMessage-DrkRoaJe.js";import{F as D}from"./MagnifyingGlassIcon-BGPFRbxD.js";import{F as z}from"./UserGroupIcon-BSH-_fCa.js";import{F as O}from"./UserPlusIcon-DBG4Opr5.js";function U({title:n,titleId:a,...e},r){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":a},e),n?u.createElement("title",{id:a},n):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M22 10.5h-6m-2.25-4.125a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0ZM4 19.235v-.11a6.375 6.375 0 0 1 12.75 0v.109A12.318 12.318 0 0 1 10.374 21c-2.331 0-4.512-.645-6.374-1.766Z"}))}const A=u.forwardRef(U),Y=async(n={})=>{var a,e;try{const r=n.page||1,t=n.page_size||10,i={...n,page:r,page_size:t};Object.keys(i).forEach(d=>(i[d]===void 0||i[d]==="")&&delete i[d]);const g=await h.get("/network/",{params:i,_fullResponse:!0});return{data:g.data,headers:g.headers,status:g.status}}catch(r){if(console.error("Error fetching network data:",r),r.response){const t=((a=r.response.data)==null?void 0:a.detail)||((e=r.response.data)==null?void 0:e.message)||"Failed to fetch network data",i=new Error(t);throw i.response=r.response,i}else throw r.request?new Error("No response received from the server. Please check your network connection."):new Error(`Request failed: ${r.message}`)}},Q=async n=>{var a;if(!n)throw new Error("User ID is required to send a connection request");try{return(await h.post("/network/connections/request/",{user_id:n})).data}catch(e){if(console.error("Error sending connection request:",e),e.response){const r=((a=e.response.data)==null?void 0:a.detail)||Object.values(e.response.data||{}).flat().join(`
`)||"Failed to send connection request",t=new Error(r);throw t.response=e.response,t}throw e}},T=async n=>{var a;if(!n)throw new Error("Request ID is required to accept a connection");try{return(await h.post(`/network/connections/${n}/accept/`)).data}catch(e){if(console.error("Error accepting connection request:",e),e.response){const r=((a=e.response.data)==null?void 0:a.detail)||Object.values(e.response.data||{}).flat().join(`
`)||"Failed to accept connection request",t=new Error(r);throw t.response=e.response,t}throw e}},Z=async n=>{var a;if(!n)throw new Error("Request ID is required to decline a connection");try{return(await h.post(`/network/connections/${n}/decline/`)).data}catch(e){if(console.error("Error declining connection request:",e),e.response){const r=((a=e.response.data)==null?void 0:a.detail)||Object.values(e.response.data||{}).flat().join(`
`)||"Failed to decline connection request",t=new Error(r);throw t.response=e.response,t}throw e}},B=async n=>{var a;if(!n)throw new Error("Connection ID is required to remove a connection");try{return(await h.delete(`/network/connections/${n}/`)).data}catch(e){if(console.error("Error removing connection:",e),e.response){const r=((a=e.response.data)==null?void 0:a.detail)||Object.values(e.response.data||{}).flat().join(`
`)||"Failed to remove connection",t=new Error(r);throw t.response=e.response,t}throw e}},J=async(n,a={})=>{var e;if(!n)throw new Error("Search query is required");try{return(await h.get("/network/search/",{params:{q:n,...a}})).data}catch(r){if(console.error("Error searching users:",r),r.response){const t=((e=r.response.data)==null?void 0:e.detail)||"Failed to search users",i=new Error(t);throw i.response=r.response,i}throw r}},K=n=>{const a={count:0,next:null,previous:null,totalPages:1,currentPage:1};try{if(n["x-pagination"]){const e=JSON.parse(n["x-pagination"]);return{count:e.count||0,next:e.next||null,previous:e.previous||null,totalPages:e.total_pages||1,currentPage:e.current_page||1}}}catch(e){console.error("Error parsing pagination:",e)}return a},W=L((n,a)=>({connections:[],pendingRequests:[],suggestions:[],searchResults:[],isLoading:!1,isSearching:!1,error:null,pagination:{count:0,next:null,previous:null,totalPages:1,currentPage:1},get currentPage(){return a().pagination.currentPage},get totalPages(){return a().pagination.totalPages},get totalCount(){return a().pagination.count},fetchNetworkData:async(e={})=>{n({isLoading:!0,error:null});try{const r=await Y(e),t=K(r.headers),{connections:i=[],pending_requests:g=[],suggestions:d=[]}=r.data;return n({connections:i,pendingRequests:g,suggestions:d,pagination:{...t,count:r.data.count||i.length,totalPages:Math.ceil((r.data.count||i.length)/(e.page_size||10)),currentPage:parseInt(e.page||1,10)},isLoading:!1}),r.data}catch(r){const t=r.message||"Failed to fetch network data";throw n({error:t,isLoading:!1}),r}},searchUsers:async(e,r={})=>{if(!e)return n({searchResults:[],isSearching:!1}),[];n({isSearching:!0,error:null});try{const t=await J(e,r);return n({searchResults:t,isSearching:!1}),t}catch(t){const i=t.message||"Failed to search users";throw n({error:i,isSearching:!1,searchResults:[]}),t}},sendConnectionRequest:async e=>{n({isLoading:!0,error:null});try{const r=await Q(e);return n(t=>({suggestions:t.suggestions.filter(i=>i.id!==e),isLoading:!1})),r}catch(r){const t=r.message||"Failed to send connection request";throw n({error:t,isLoading:!1}),r}},acceptConnectionRequest:async e=>{n({isLoading:!0,error:null});try{const r=await T(e);return n(t=>({pendingRequests:t.pendingRequests.filter(i=>i.id!==e),connections:[...t.connections,r],isLoading:!1})),r}catch(r){const t=r.message||"Failed to accept connection request";throw n({error:t,isLoading:!1}),r}},declineConnectionRequest:async e=>{n({isLoading:!0,error:null});try{return await Z(e),n(r=>({pendingRequests:r.pendingRequests.filter(t=>t.id!==e),isLoading:!1})),!0}catch(r){const t=r.message||"Failed to decline connection request";throw n({error:t,isLoading:!1}),r}},removeConnection:async e=>{n({isLoading:!0,error:null});try{return await B(e),n(r=>({connections:r.connections.filter(t=>t.id!==e),isLoading:!1})),!0}catch(r){const t=r.message||"Failed to remove connection";throw n({error:t,isLoading:!1}),r}},clear:()=>n({connections:[],pendingRequests:[],suggestions:[],searchResults:[],error:null,pagination:{count:0,next:null,previous:null,totalPages:1,currentPage:1}})})),ee=()=>{M(),_();const{connections:n,pendingRequests:a,suggestions:e,searchResults:r,isLoading:t,isSearching:i,error:g,fetchNetworkData:d,searchUsers:f,sendConnectionRequest:w,acceptConnectionRequest:y,declineConnectionRequest:v,removeConnection:j}=W(),[l,b]=u.useState("");u.useEffect(()=>{d()},[d]),u.useEffect(()=>{const o=setTimeout(()=>{l.trim()&&f(l)},500);return()=>clearTimeout(o)},[l,f]);const k=async o=>{try{await w(o)}catch(c){console.error("Failed to send connection request:",c)}},N=async o=>{try{await y(o)}catch(c){console.error("Failed to accept connection request:",c)}},q=async o=>{try{await v(o)}catch(c){console.error("Failed to decline connection request:",c)}},R=async o=>{if(window.confirm("Are you sure you want to remove this connection?"))try{await j(o)}catch(c){console.error("Failed to remove connection:",c)}},x=(o,c="suggestion")=>s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 flex items-center justify-between hover:shadow-md transition-shadow",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"h-12 w-12 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center overflow-hidden",children:o.profile_picture?s.jsx("img",{src:o.profile_picture,alt:`${o.first_name} ${o.last_name}`,className:"h-full w-full object-cover"}):s.jsx(z,{className:"h-6 w-6 text-gray-400"})})}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[o.first_name," ",o.last_name]}),o.headline&&s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate max-w-xs",children:o.headline}),o.mutual_connections>0&&s.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[o.mutual_connections," mutual connection",o.mutual_connections!==1?"s":""]})]})]}),s.jsxs("div",{className:"flex space-x-2",children:[c==="suggestion"&&s.jsxs("button",{onClick:()=>k(o.id),className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[s.jsx(O,{className:"h-4 w-4 mr-1"}),"Connect"]}),c==="pending"&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>N(o.request_id||o.id),className:"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",title:"Accept",children:s.jsx(P,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>q(o.request_id||o.id),className:"inline-flex items-center px-2 py-1 border border-gray-300 dark:border-gray-600 text-xs font-medium rounded-md text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",title:"Decline",children:s.jsx(S,{className:"h-4 w-4"})})]}),c==="connection"&&s.jsxs("button",{onClick:()=>R(o.connection_id||o.id),className:"inline-flex items-center px-3 py-1.5 border border-gray-300 dark:border-gray-600 text-xs font-medium rounded-md text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",title:"Remove connection",children:[s.jsx(A,{className:"h-4 w-4 mr-1"}),"Remove"]})]})]},o.id),p=(o,c,E,C="No items to display")=>s.jsxs("div",{className:"mb-8",children:[s.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:o}),t&&c.length===0?s.jsx("div",{className:"flex justify-center py-8",children:s.jsx(m,{size:"md"})}):g&&c.length===0?s.jsx($,{message:g,onRetry:d}):c.length>0?s.jsx("div",{className:"grid grid-cols-1 gap-4",children:c.map(F=>x(F,E))}):s.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:C})]});return s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"My Network"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Manage your connections and grow your professional network"})]}),s.jsx("div",{className:"mb-8",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(D,{className:"h-5 w-5 text-gray-400"})}),s.jsx("input",{type:"text",placeholder:"Search for people to connect with...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md leading-5 bg-white dark:bg-gray-800 placeholder-gray-500 dark:placeholder-gray-400 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",value:l,onChange:o=>b(o.target.value)}),i&&s.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:s.jsx(m,{size:"sm"})})]})}),l.trim()&&s.jsxs("div",{className:"mb-8",children:[s.jsxs("h2",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:['Search Results for "',l,'"']}),i&&r.length===0?s.jsx("div",{className:"flex justify-center py-8",children:s.jsx(m,{size:"md"})}):r.length>0?s.jsx("div",{className:"grid grid-cols-1 gap-4",children:r.map(o=>x(o,"suggestion"))}):l.trim()?s.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:['No users found matching "',l,'"']}):null]}),!l.trim()&&p("Connection Requests",a,"pending","You have no pending connection requests."),!l.trim()&&p("People You May Know",e,"suggestion","No suggestions available at the moment."),!l.trim()&&p("Your Connections",n,"connection","You have not connected with anyone yet.")]})};export{ee as default};
//# sourceMappingURL=NetworkPage-CwNJpD3Q.js.map
