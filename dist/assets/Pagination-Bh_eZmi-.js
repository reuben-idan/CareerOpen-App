import{e as w,j as i,an as j,ao as v,ap as k,aq as R,P as h}from"./vendor-B42s3pmA.js";import{d as b}from"./index-DKFhryC_.js";import"react";const N=async(r={})=>{var a,t;try{const e=r.page||1,l=r.page_size||10,s={...r,page:e,page_size:l};Object.keys(s).forEach(n=>(s[n]===void 0||s[n]==="")&&delete s[n]);const o=await b.get("/jobs/",{params:s,_fullResponse:!0});return{data:o.data,headers:o.headers,status:o.status}}catch(e){if(console.error("Error fetching jobs:",e),e.response){console.error("Response data:",e.response.data),console.error("Response status:",e.response.status),console.error("Response headers:",e.response.headers);const l=((a=e.response.data)==null?void 0:a.detail)||((t=e.response.data)==null?void 0:t.message)||"Failed to fetch jobs",s=new Error(l);throw s.response=e.response,s}else throw e.request?(console.error("No response received:",e.request),new Error("No response received from the server. Please check your network connection.")):(console.error("Request setup error:",e.message),new Error(`Request failed: ${e.message}`))}},J=async r=>{var a,t;if(!r)throw new Error("Job ID is required");try{return(await b.get(`/jobs/${r}/`)).data}catch(e){if(console.error(`Error fetching job ${r}:`,e),e.response){if(e.response.status===404)throw new Error(`Job with ID ${r} not found`);const l=((a=e.response.data)==null?void 0:a.detail)||((t=e.response.data)==null?void 0:t.message)||`Failed to fetch job ${r}`,s=new Error(l);throw s.response=e.response,s}throw e}},E=r=>{const a={count:0,next:null,previous:null,totalPages:1,currentPage:1};try{if(r["x-pagination"]){const t=JSON.parse(r["x-pagination"]);return{count:t.count||0,next:t.next||null,previous:t.previous||null,totalPages:t.total_pages||1,currentPage:t.current_page||1}}}catch(t){console.error("Error parsing pagination:",t)}return a},q=w((r,a)=>({jobs:[],currentJob:null,isLoading:!1,error:null,pagination:{count:0,next:null,previous:null,totalPages:1,currentPage:1},get currentPage(){return a().pagination.currentPage},get totalPages(){return a().pagination.totalPages},get totalCount(){return a().pagination.count},fetchJobs:async(t={})=>{var e,l,s,o;r({isLoading:!0,error:null});try{const n=await N(t),d=E(n.headers);return r({jobs:n.data.results||n.data,pagination:{...d,count:n.data.count||n.data.length||0,next:n.data.next||null,previous:n.data.previous||null,totalPages:Math.ceil((n.data.count||n.data.length||0)/(t.page_size||10)),currentPage:parseInt(t.page||1,10)},isLoading:!1}),n.data.results||n.data}catch(n){const d=((l=(e=n.response)==null?void 0:e.data)==null?void 0:l.detail)||((o=(s=n.response)==null?void 0:s.data)==null?void 0:o.message)||"Failed to fetch jobs";throw r({error:d,isLoading:!1}),new Error(d)}},fetchJobById:async t=>{var e,l,s;if(((e=a().currentJob)==null?void 0:e.id)===t)return a().currentJob;r({isLoading:!0,error:null});try{const o=await J(t);return r({currentJob:o,isLoading:!1}),o}catch(o){const n=((s=(l=o.response)==null?void 0:l.data)==null?void 0:s.detail)||`Failed to fetch job ${t}`;throw r({error:n,isLoading:!1}),new Error(n)}},setCurrentJob:t=>r({currentJob:t}),clear:()=>{r({jobs:[],currentJob:null,error:null,pagination:{count:0,next:null,previous:null,totalPages:1,currentPage:1}})},createJob:async t=>{r({isLoading:!0,error:null});try{const e=await fetch("/api/v1/jobs/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`},body:JSON.stringify(t)});if(!e.ok){const s=await e.json();throw new Error(s.detail||"Failed to create job")}const l=await e.json();return r(s=>({jobs:[l,...s.jobs],isLoading:!1})),l}catch(e){throw console.error("Error creating job:",e),r({error:e.message,isLoading:!1}),e}}})),$=({currentPage:r,totalPages:a,pageNeighbours:t=2,onPageChange:e,className:l="",...s})=>{if(a<=1)return null;const o=(c,u)=>Array.from({length:u-c+1},(g,p)=>c+p),d=(()=>{const c=t*2+3;if(a<=c)return o(1,a);const u=Math.max(2,r-t),g=Math.min(a-1,r+t),p=u>2,f=g<a-1;return!p&&f?[...o(1,3+2*t),"...",a]:p&&!f?[1,"...",...o(a-(3+2*t)+1,a)]:p&&f?[1,"...",...o(u,g),"...",a]:o(1,a)})(),m=r===1,x=r===a;return i.jsx("nav",{className:`flex items-center justify-between px-4 sm:px-0 ${l}`,"aria-label":"Pagination",...s,children:i.jsxs("div",{className:"flex-1 flex justify-between sm:justify-end space-x-2",children:[i.jsxs("button",{onClick:()=>e(1),disabled:m,className:`relative inline-flex items-center px-2 py-2 rounded-md text-sm font-medium ${m?"text-gray-400 dark:text-gray-600 cursor-not-allowed":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,"aria-label":"First page",children:[i.jsx("span",{className:"sr-only",children:"First"}),i.jsx(j,{className:"h-5 w-5","aria-hidden":"true"})]}),i.jsxs("button",{onClick:()=>e(r-1),disabled:m,className:`relative inline-flex items-center px-2 py-2 rounded-md text-sm font-medium ${m?"text-gray-400 dark:text-gray-600 cursor-not-allowed":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,"aria-label":"Previous",children:[i.jsx("span",{className:"sr-only",children:"Previous"}),i.jsx(v,{className:"h-5 w-5","aria-hidden":"true"})]}),i.jsx("div",{className:"hidden sm:flex space-x-1",children:d.map((c,u)=>{if(c==="...")return i.jsx("span",{className:"relative inline-flex items-center px-4 py-2 text-sm font-medium text-gray-500",children:"..."},`ellipsis-${u}`);const g=c===r;return i.jsx("button",{onClick:()=>e(c),className:`relative inline-flex items-center px-4 py-2 text-sm font-medium ${g?"bg-indigo-600 text-white dark:bg-indigo-700":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"} rounded-md`,"aria-current":g?"page":void 0,children:c},c)})}),i.jsxs("button",{onClick:()=>e(r+1),disabled:x,className:`relative inline-flex items-center px-2 py-2 rounded-md text-sm font-medium ${x?"text-gray-400 dark:text-gray-600 cursor-not-allowed":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,"aria-label":"Next",children:[i.jsx("span",{className:"sr-only",children:"Next"}),i.jsx(k,{className:"h-5 w-5","aria-hidden":"true"})]}),i.jsxs("button",{onClick:()=>e(a),disabled:x,className:`relative inline-flex items-center px-2 py-2 rounded-md text-sm font-medium ${x?"text-gray-400 dark:text-gray-600 cursor-not-allowed":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,"aria-label":"Last page",children:[i.jsx("span",{className:"sr-only",children:"Last"}),i.jsx(R,{className:"h-5 w-5","aria-hidden":"true"})]})]})})};$.propTypes={currentPage:h.number.isRequired,totalPages:h.number.isRequired,pageNeighbours:h.number,onPageChange:h.func.isRequired,className:h.string};export{$ as P,q as u};
//# sourceMappingURL=Pagination-Bh_eZmi-.js.map
