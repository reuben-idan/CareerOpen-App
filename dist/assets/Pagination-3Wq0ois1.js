import{h as e,i as r,a as t,j as a}from"./index-C0ISbAl6.js";import{r as n}from"./react-vendor-Blpmel2Z.js";import{P as o}from"./ui-components-Cj_Nz0sg.js";import{F as s,a as i}from"./ChevronRightIcon-yrNv7oIn.js";function l({title:e,titleId:r,...t},a){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},t),e?n.createElement("title",{id:r},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m18.75 4.5-7.5 7.5 7.5 7.5m-6-15L5.25 12l7.5 7.5"}))}const d=n.forwardRef(l);function c({title:e,titleId:r,...t},a){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},t),e?n.createElement("title",{id:r},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m5.25 4.5 7.5 7.5-7.5 7.5m6-15 7.5 7.5-7.5 7.5"}))}const u=n.forwardRef(c),g=r((r,t)=>({jobs:[],currentJob:null,isLoading:!1,error:null,pagination:{count:0,next:null,previous:null,totalPages:1,currentPage:1},get currentPage(){return t().pagination.currentPage},get totalPages(){return t().pagination.totalPages},get totalCount(){return t().pagination.count},fetchJobs:async(t={})=>{var a,n,o,s;r({isLoading:!0,error:null});try{const a=await(async(r={})=>{var t,a;try{const t=r.page||1,a=r.page_size||10,n={...r,page:t,page_size:a};Object.keys(n).forEach(e=>(void 0===n[e]||""===n[e])&&delete n[e]);const o=await e.get("/jobs/",{params:n,_fullResponse:!0});return{data:o.data,headers:o.headers,status:o.status}}catch(n){if(console.error("Error fetching jobs:",n),n.response){console.error("Response data:",n.response.data),console.error("Response status:",n.response.status),console.error("Response headers:",n.response.headers);const e=(null==(t=n.response.data)?void 0:t.detail)||(null==(a=n.response.data)?void 0:a.message)||"Failed to fetch jobs",r=new Error(e);throw r.response=n.response,r}throw n.request?(console.error("No response received:",n.request),new Error("No response received from the server. Please check your network connection.")):(console.error("Request setup error:",n.message),new Error(`Request failed: ${n.message}`))}})(t),n=(e=>{try{if(e["x-pagination"]){const r=JSON.parse(e["x-pagination"]);return{count:r.count||0,next:r.next||null,previous:r.previous||null,totalPages:r.total_pages||1,currentPage:r.current_page||1}}}catch(r){console.error("Error parsing pagination:",r)}return{count:0,next:null,previous:null,totalPages:1,currentPage:1}})(a.headers);return r({jobs:a.data.results||a.data,pagination:{...n,count:a.data.count||a.data.length||0,next:a.data.next||null,previous:a.data.previous||null,totalPages:Math.ceil((a.data.count||a.data.length||0)/(t.page_size||10)),currentPage:parseInt(t.page||1,10)},isLoading:!1}),a.data.results||a.data}catch(i){const e=(null==(n=null==(a=i.response)?void 0:a.data)?void 0:n.detail)||(null==(s=null==(o=i.response)?void 0:o.data)?void 0:s.message)||"Failed to fetch jobs";throw r({error:e,isLoading:!1}),new Error(e)}},fetchJobById:async a=>{var n,o,s;if((null==(n=t().currentJob)?void 0:n.id)===a)return t().currentJob;r({isLoading:!0,error:null});try{const t=await(async r=>{var t,a;if(!r)throw new Error("Job ID is required");try{return(await e.get(`/jobs/${r}/`)).data}catch(n){if(console.error(`Error fetching job ${r}:`,n),n.response){if(404===n.response.status)throw new Error(`Job with ID ${r} not found`);const e=(null==(t=n.response.data)?void 0:t.detail)||(null==(a=n.response.data)?void 0:a.message)||`Failed to fetch job ${r}`,o=new Error(e);throw o.response=n.response,o}throw n}})(a);return r({currentJob:t,isLoading:!1}),t}catch(i){const e=(null==(s=null==(o=i.response)?void 0:o.data)?void 0:s.detail)||`Failed to fetch job ${a}`;throw r({error:e,isLoading:!1}),new Error(e)}},setCurrentJob:e=>r({currentJob:e}),clear:()=>{r({jobs:[],currentJob:null,error:null,pagination:{count:0,next:null,previous:null,totalPages:1,currentPage:1}})},createJob:async e=>{r({isLoading:!0,error:null});try{const t=await fetch("/api/v1/jobs/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.detail||"Failed to create job")}const a=await t.json();return r(e=>({jobs:[a,...e.jobs],isLoading:!1})),a}catch(t){throw console.error("Error creating job:",t),r({error:t.message,isLoading:!1}),t}}})),p=({currentPage:e,totalPages:r,pageNeighbours:n=2,onPageChange:o,className:l="",...c})=>{if(r<=1)return null;const g=(e,r)=>Array.from({length:r-e+1},(r,t)=>e+t),p=(()=>{if(r<=2*n+3)return g(1,r);const t=Math.max(2,e-n),a=Math.min(r-1,e+n),o=t>2,s=a<r-1;if(!o&&s){return[...g(1,3+2*n),"...",r]}if(o&&!s){return[1,"...",...g(r-(3+2*n)+1,r)]}if(o&&s){return[1,"...",...g(t,a),"...",r]}return g(1,r)})(),h=1===e,m=e===r;return t("nav",{className:`flex items-center justify-between px-4 sm:px-0 ${l}`,"aria-label":"Pagination",...c,children:a("div",{className:"flex-1 flex justify-between sm:justify-end space-x-2",children:[a("button",{onClick:()=>o(1),disabled:h,className:"relative inline-flex items-center px-2 py-2 rounded-md text-sm font-medium "+(h?"text-gray-400 dark:text-gray-600 cursor-not-allowed":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"),"aria-label":"First page",children:[t("span",{className:"sr-only",children:"First"}),t(d,{className:"h-5 w-5","aria-hidden":"true"})]}),a("button",{onClick:()=>o(e-1),disabled:h,className:"relative inline-flex items-center px-2 py-2 rounded-md text-sm font-medium "+(h?"text-gray-400 dark:text-gray-600 cursor-not-allowed":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"),"aria-label":"Previous",children:[t("span",{className:"sr-only",children:"Previous"}),t(s,{className:"h-5 w-5","aria-hidden":"true"})]}),t("div",{className:"hidden sm:flex space-x-1",children:p.map((r,a)=>{if("..."===r)return t("span",{className:"relative inline-flex items-center px-4 py-2 text-sm font-medium text-gray-500",children:"..."},`ellipsis-${a}`);const n=r===e;return t("button",{onClick:()=>o(r),className:`relative inline-flex items-center px-4 py-2 text-sm font-medium ${n?"bg-indigo-600 text-white dark:bg-indigo-700":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"} rounded-md`,"aria-current":n?"page":void 0,children:r},r)})}),a("button",{onClick:()=>o(e+1),disabled:m,className:"relative inline-flex items-center px-2 py-2 rounded-md text-sm font-medium "+(m?"text-gray-400 dark:text-gray-600 cursor-not-allowed":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"),"aria-label":"Next",children:[t("span",{className:"sr-only",children:"Next"}),t(i,{className:"h-5 w-5","aria-hidden":"true"})]}),a("button",{onClick:()=>o(r),disabled:m,className:"relative inline-flex items-center px-2 py-2 rounded-md text-sm font-medium "+(m?"text-gray-400 dark:text-gray-600 cursor-not-allowed":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"),"aria-label":"Last page",children:[t("span",{className:"sr-only",children:"Last"}),t(u,{className:"h-5 w-5","aria-hidden":"true"})]})]})})};p.propTypes={currentPage:o.number.isRequired,totalPages:o.number.isRequired,pageNeighbours:o.number,onPageChange:o.func.isRequired,className:o.string};export{p as P,g as u};
//# sourceMappingURL=Pagination-3Wq0ois1.js.map
