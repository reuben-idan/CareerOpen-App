import{r as d,l as w,m as v,j as i,P as h}from"./index-CAXHRMTp.js";import{F as j,a as k}from"./ChevronRightIcon-BM1XR6Uj.js";function R({title:r,titleId:a,...t},e){return d.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:e,"aria-labelledby":a},t),r?d.createElement("title",{id:a},r):null,d.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m18.75 4.5-7.5 7.5 7.5 7.5m-6-15L5.25 12l7.5 7.5"}))}const E=d.forwardRef(R);function N({title:r,titleId:a,...t},e){return d.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:e,"aria-labelledby":a},t),r?d.createElement("title",{id:a},r):null,d.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m5.25 4.5 7.5 7.5-7.5 7.5m6-15 7.5 7.5-7.5 7.5"}))}const L=d.forwardRef(N),J=async(r={})=>{var a,t;try{const e=r.page||1,l=r.page_size||10,n={...r,page:e,page_size:l};Object.keys(n).forEach(s=>(n[s]===void 0||n[s]==="")&&delete n[s]);const o=await w.get("/jobs/",{params:n,_fullResponse:!0});return{data:o.data,headers:o.headers,status:o.status}}catch(e){if(console.error("Error fetching jobs:",e),e.response){console.error("Response data:",e.response.data),console.error("Response status:",e.response.status),console.error("Response headers:",e.response.headers);const l=((a=e.response.data)==null?void 0:a.detail)||((t=e.response.data)==null?void 0:t.message)||"Failed to fetch jobs",n=new Error(l);throw n.response=e.response,n}else throw e.request?(console.error("No response received:",e.request),new Error("No response received from the server. Please check your network connection.")):(console.error("Request setup error:",e.message),new Error(`Request failed: ${e.message}`))}},$=async r=>{var a,t;if(!r)throw new Error("Job ID is required");try{return(await w.get(`/jobs/${r}/`)).data}catch(e){if(console.error(`Error fetching job ${r}:`,e),e.response){if(e.response.status===404)throw new Error(`Job with ID ${r} not found`);const l=((a=e.response.data)==null?void 0:a.detail)||((t=e.response.data)==null?void 0:t.message)||`Failed to fetch job ${r}`,n=new Error(l);throw n.response=e.response,n}throw e}},F=r=>{const a={count:0,next:null,previous:null,totalPages:1,currentPage:1};try{if(r["x-pagination"]){const t=JSON.parse(r["x-pagination"]);return{count:t.count||0,next:t.next||null,previous:t.previous||null,totalPages:t.total_pages||1,currentPage:t.current_page||1}}}catch(t){console.error("Error parsing pagination:",t)}return a},D=v((r,a)=>({jobs:[],currentJob:null,isLoading:!1,error:null,pagination:{count:0,next:null,previous:null,totalPages:1,currentPage:1},get currentPage(){return a().pagination.currentPage},get totalPages(){return a().pagination.totalPages},get totalCount(){return a().pagination.count},fetchJobs:async(t={})=>{var e,l,n,o;r({isLoading:!0,error:null});try{const s=await J(t),u=F(s.headers);return r({jobs:s.data.results||s.data,pagination:{...u,count:s.data.count||s.data.length||0,next:s.data.next||null,previous:s.data.previous||null,totalPages:Math.ceil((s.data.count||s.data.length||0)/(t.page_size||10)),currentPage:parseInt(t.page||1,10)},isLoading:!1}),s.data.results||s.data}catch(s){const u=((l=(e=s.response)==null?void 0:e.data)==null?void 0:l.detail)||((o=(n=s.response)==null?void 0:n.data)==null?void 0:o.message)||"Failed to fetch jobs";throw r({error:u,isLoading:!1}),new Error(u)}},fetchJobById:async t=>{var e,l,n;if(((e=a().currentJob)==null?void 0:e.id)===t)return a().currentJob;r({isLoading:!0,error:null});try{const o=await $(t);return r({currentJob:o,isLoading:!1}),o}catch(o){const s=((n=(l=o.response)==null?void 0:l.data)==null?void 0:n.detail)||`Failed to fetch job ${t}`;throw r({error:s,isLoading:!1}),new Error(s)}},setCurrentJob:t=>r({currentJob:t}),clear:()=>{r({jobs:[],currentJob:null,error:null,pagination:{count:0,next:null,previous:null,totalPages:1,currentPage:1}})},createJob:async t=>{r({isLoading:!0,error:null});try{const e=await fetch("/api/v1/jobs/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`},body:JSON.stringify(t)});if(!e.ok){const n=await e.json();throw new Error(n.detail||"Failed to create job")}const l=await e.json();return r(n=>({jobs:[l,...n.jobs],isLoading:!1})),l}catch(e){throw console.error("Error creating job:",e),r({error:e.message,isLoading:!1}),e}}})),P=({currentPage:r,totalPages:a,pageNeighbours:t=2,onPageChange:e,className:l="",...n})=>{if(a<=1)return null;const o=(c,g)=>Array.from({length:g-c+1},(p,m)=>c+m),u=(()=>{const c=t*2+3;if(a<=c)return o(1,a);const g=Math.max(2,r-t),p=Math.min(a-1,r+t),m=g>2,b=p<a-1;return!m&&b?[...o(1,3+2*t),"...",a]:m&&!b?[1,"...",...o(a-(3+2*t)+1,a)]:m&&b?[1,"...",...o(g,p),"...",a]:o(1,a)})(),x=r===1,f=r===a;return i.jsx("nav",{className:`flex items-center justify-between px-4 sm:px-0 ${l}`,"aria-label":"Pagination",...n,children:i.jsxs("div",{className:"flex-1 flex justify-between sm:justify-end space-x-2",children:[i.jsxs("button",{onClick:()=>e(1),disabled:x,className:`relative inline-flex items-center px-2 py-2 rounded-md text-sm font-medium ${x?"text-gray-400 dark:text-gray-600 cursor-not-allowed":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,"aria-label":"First page",children:[i.jsx("span",{className:"sr-only",children:"First"}),i.jsx(E,{className:"h-5 w-5","aria-hidden":"true"})]}),i.jsxs("button",{onClick:()=>e(r-1),disabled:x,className:`relative inline-flex items-center px-2 py-2 rounded-md text-sm font-medium ${x?"text-gray-400 dark:text-gray-600 cursor-not-allowed":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,"aria-label":"Previous",children:[i.jsx("span",{className:"sr-only",children:"Previous"}),i.jsx(j,{className:"h-5 w-5","aria-hidden":"true"})]}),i.jsx("div",{className:"hidden sm:flex space-x-1",children:u.map((c,g)=>{if(c==="...")return i.jsx("span",{className:"relative inline-flex items-center px-4 py-2 text-sm font-medium text-gray-500",children:"..."},`ellipsis-${g}`);const p=c===r;return i.jsx("button",{onClick:()=>e(c),className:`relative inline-flex items-center px-4 py-2 text-sm font-medium ${p?"bg-indigo-600 text-white dark:bg-indigo-700":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"} rounded-md`,"aria-current":p?"page":void 0,children:c},c)})}),i.jsxs("button",{onClick:()=>e(r+1),disabled:f,className:`relative inline-flex items-center px-2 py-2 rounded-md text-sm font-medium ${f?"text-gray-400 dark:text-gray-600 cursor-not-allowed":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,"aria-label":"Next",children:[i.jsx("span",{className:"sr-only",children:"Next"}),i.jsx(k,{className:"h-5 w-5","aria-hidden":"true"})]}),i.jsxs("button",{onClick:()=>e(a),disabled:f,className:`relative inline-flex items-center px-2 py-2 rounded-md text-sm font-medium ${f?"text-gray-400 dark:text-gray-600 cursor-not-allowed":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,"aria-label":"Last page",children:[i.jsx("span",{className:"sr-only",children:"Last"}),i.jsx(L,{className:"h-5 w-5","aria-hidden":"true"})]})]})})};P.propTypes={currentPage:h.number.isRequired,totalPages:h.number.isRequired,pageNeighbours:h.number,onPageChange:h.func.isRequired,className:h.string};export{P,D as u};
//# sourceMappingURL=Pagination-C6flAdRu.js.map
