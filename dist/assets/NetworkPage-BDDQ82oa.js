import{e as _,y as L,j as t,C as P,I as S,S as M,l as $,d as D,T as z}from"./vendor-B42s3pmA.js";import{useState as O,useEffect as x}from"react";import{d as u,e as U,L as p}from"./index-DEXg1UWV.js";import{E as A}from"./ErrorMessage-BHf3m2He.js";import"react-dom";const Y=async(s={})=>{var a,e;try{const r=s.page||1,n=s.page_size||10,i={...s,page:r,page_size:n};Object.keys(i).forEach(d=>(i[d]===void 0||i[d]==="")&&delete i[d]);const g=await u.get("/network/",{params:i,_fullResponse:!0});return{data:g.data,headers:g.headers,status:g.status}}catch(r){if(console.error("Error fetching network data:",r),r.response){const n=((a=r.response.data)==null?void 0:a.detail)||((e=r.response.data)==null?void 0:e.message)||"Failed to fetch network data",i=new Error(n);throw i.response=r.response,i}else throw r.request?new Error("No response received from the server. Please check your network connection."):new Error(`Request failed: ${r.message}`)}},T=async s=>{var a;if(!s)throw new Error("User ID is required to send a connection request");try{return(await u.post("/network/connections/request/",{user_id:s})).data}catch(e){if(console.error("Error sending connection request:",e),e.response){const r=((a=e.response.data)==null?void 0:a.detail)||Object.values(e.response.data||{}).flat().join(`
`)||"Failed to send connection request",n=new Error(r);throw n.response=e.response,n}throw e}},Q=async s=>{var a;if(!s)throw new Error("Request ID is required to accept a connection");try{return(await u.post(`/network/connections/${s}/accept/`)).data}catch(e){if(console.error("Error accepting connection request:",e),e.response){const r=((a=e.response.data)==null?void 0:a.detail)||Object.values(e.response.data||{}).flat().join(`
`)||"Failed to accept connection request",n=new Error(r);throw n.response=e.response,n}throw e}},J=async s=>{var a;if(!s)throw new Error("Request ID is required to decline a connection");try{return(await u.post(`/network/connections/${s}/decline/`)).data}catch(e){if(console.error("Error declining connection request:",e),e.response){const r=((a=e.response.data)==null?void 0:a.detail)||Object.values(e.response.data||{}).flat().join(`
`)||"Failed to decline connection request",n=new Error(r);throw n.response=e.response,n}throw e}},K=async s=>{var a;if(!s)throw new Error("Connection ID is required to remove a connection");try{return(await u.delete(`/network/connections/${s}/`)).data}catch(e){if(console.error("Error removing connection:",e),e.response){const r=((a=e.response.data)==null?void 0:a.detail)||Object.values(e.response.data||{}).flat().join(`
`)||"Failed to remove connection",n=new Error(r);throw n.response=e.response,n}throw e}},B=async(s,a={})=>{var e;if(!s)throw new Error("Search query is required");try{return(await u.get("/network/search/",{params:{q:s,...a}})).data}catch(r){if(console.error("Error searching users:",r),r.response){const n=((e=r.response.data)==null?void 0:e.detail)||"Failed to search users",i=new Error(n);throw i.response=r.response,i}throw r}},G=s=>{const a={count:0,next:null,previous:null,totalPages:1,currentPage:1};try{if(s["x-pagination"]){const e=JSON.parse(s["x-pagination"]);return{count:e.count||0,next:e.next||null,previous:e.previous||null,totalPages:e.total_pages||1,currentPage:e.current_page||1}}}catch(e){console.error("Error parsing pagination:",e)}return a},H=_((s,a)=>({connections:[],pendingRequests:[],suggestions:[],searchResults:[],isLoading:!1,isSearching:!1,error:null,pagination:{count:0,next:null,previous:null,totalPages:1,currentPage:1},get currentPage(){return a().pagination.currentPage},get totalPages(){return a().pagination.totalPages},get totalCount(){return a().pagination.count},fetchNetworkData:async(e={})=>{s({isLoading:!0,error:null});try{const r=await Y(e),n=G(r.headers),{connections:i=[],pending_requests:g=[],suggestions:d=[]}=r.data;return s({connections:i,pendingRequests:g,suggestions:d,pagination:{...n,count:r.data.count||i.length,totalPages:Math.ceil((r.data.count||i.length)/(e.page_size||10)),currentPage:parseInt(e.page||1,10)},isLoading:!1}),r.data}catch(r){const n=r.message||"Failed to fetch network data";throw s({error:n,isLoading:!1}),r}},searchUsers:async(e,r={})=>{if(!e)return s({searchResults:[],isSearching:!1}),[];s({isSearching:!0,error:null});try{const n=await B(e,r);return s({searchResults:n,isSearching:!1}),n}catch(n){const i=n.message||"Failed to search users";throw s({error:i,isSearching:!1,searchResults:[]}),n}},sendConnectionRequest:async e=>{s({isLoading:!0,error:null});try{const r=await T(e);return s(n=>({suggestions:n.suggestions.filter(i=>i.id!==e),isLoading:!1})),r}catch(r){const n=r.message||"Failed to send connection request";throw s({error:n,isLoading:!1}),r}},acceptConnectionRequest:async e=>{s({isLoading:!0,error:null});try{const r=await Q(e);return s(n=>({pendingRequests:n.pendingRequests.filter(i=>i.id!==e),connections:[...n.connections,r],isLoading:!1})),r}catch(r){const n=r.message||"Failed to accept connection request";throw s({error:n,isLoading:!1}),r}},declineConnectionRequest:async e=>{s({isLoading:!0,error:null});try{return await J(e),s(r=>({pendingRequests:r.pendingRequests.filter(n=>n.id!==e),isLoading:!1})),!0}catch(r){const n=r.message||"Failed to decline connection request";throw s({error:n,isLoading:!1}),r}},removeConnection:async e=>{s({isLoading:!0,error:null});try{return await K(e),s(r=>({connections:r.connections.filter(n=>n.id!==e),isLoading:!1})),!0}catch(r){const n=r.message||"Failed to remove connection";throw s({error:n,isLoading:!1}),r}},clear:()=>s({connections:[],pendingRequests:[],suggestions:[],searchResults:[],error:null,pagination:{count:0,next:null,previous:null,totalPages:1,currentPage:1}})})),ee=()=>{L(),U();const{connections:s,pendingRequests:a,suggestions:e,searchResults:r,isLoading:n,isSearching:i,error:g,fetchNetworkData:d,searchUsers:m,sendConnectionRequest:w,acceptConnectionRequest:y,declineConnectionRequest:v,removeConnection:j}=H(),[l,b]=O("");x(()=>{d()},[d]),x(()=>{const o=setTimeout(()=>{l.trim()&&m(l)},500);return()=>clearTimeout(o)},[l,m]);const N=async o=>{try{await w(o)}catch(c){console.error("Failed to send connection request:",c)}},k=async o=>{try{await y(o)}catch(c){console.error("Failed to accept connection request:",c)}},q=async o=>{try{await v(o)}catch(c){console.error("Failed to decline connection request:",c)}},R=async o=>{if(window.confirm("Are you sure you want to remove this connection?"))try{await j(o)}catch(c){console.error("Failed to remove connection:",c)}},f=(o,c="suggestion")=>t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 flex items-center justify-between hover:shadow-md transition-shadow",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("div",{className:"h-12 w-12 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center overflow-hidden",children:o.profile_picture?t.jsx("img",{src:o.profile_picture,alt:`${o.first_name} ${o.last_name}`,className:"h-full w-full object-cover"}):t.jsx(S,{className:"h-6 w-6 text-gray-400"})})}),t.jsxs("div",{children:[t.jsxs("h3",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[o.first_name," ",o.last_name]}),o.headline&&t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate max-w-xs",children:o.headline}),o.mutual_connections>0&&t.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[o.mutual_connections," mutual connection",o.mutual_connections!==1?"s":""]})]})]}),t.jsxs("div",{className:"flex space-x-2",children:[c==="suggestion"&&t.jsxs("button",{onClick:()=>N(o.id),className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[t.jsx(M,{className:"h-4 w-4 mr-1"}),"Connect"]}),c==="pending"&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>k(o.request_id||o.id),className:"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",title:"Accept",children:t.jsx($,{className:"h-4 w-4"})}),t.jsx("button",{onClick:()=>q(o.request_id||o.id),className:"inline-flex items-center px-2 py-1 border border-gray-300 dark:border-gray-600 text-xs font-medium rounded-md text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",title:"Decline",children:t.jsx(D,{className:"h-4 w-4"})})]}),c==="connection"&&t.jsxs("button",{onClick:()=>R(o.connection_id||o.id),className:"inline-flex items-center px-3 py-1.5 border border-gray-300 dark:border-gray-600 text-xs font-medium rounded-md text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",title:"Remove connection",children:[t.jsx(z,{className:"h-4 w-4 mr-1"}),"Remove"]})]})]},o.id),h=(o,c,E,C="No items to display")=>t.jsxs("div",{className:"mb-8",children:[t.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:o}),n&&c.length===0?t.jsx("div",{className:"flex justify-center py-8",children:t.jsx(p,{size:"md"})}):g&&c.length===0?t.jsx(A,{message:g,onRetry:d}):c.length>0?t.jsx("div",{className:"grid grid-cols-1 gap-4",children:c.map(F=>f(F,E))}):t.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:C})]});return t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[t.jsxs("div",{className:"mb-8",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"My Network"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Manage your connections and grow your professional network"})]}),t.jsx("div",{className:"mb-8",children:t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx(P,{className:"h-5 w-5 text-gray-400"})}),t.jsx("input",{type:"text",placeholder:"Search for people to connect with...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md leading-5 bg-white dark:bg-gray-800 placeholder-gray-500 dark:placeholder-gray-400 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",value:l,onChange:o=>b(o.target.value)}),i&&t.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:t.jsx(p,{size:"sm"})})]})}),l.trim()&&t.jsxs("div",{className:"mb-8",children:[t.jsxs("h2",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:['Search Results for "',l,'"']}),i&&r.length===0?t.jsx("div",{className:"flex justify-center py-8",children:t.jsx(p,{size:"md"})}):r.length>0?t.jsx("div",{className:"grid grid-cols-1 gap-4",children:r.map(o=>f(o,"suggestion"))}):l.trim()?t.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:['No users found matching "',l,'"']}):null]}),!l.trim()&&h("Connection Requests",a,"pending","You have no pending connection requests."),!l.trim()&&h("People You May Know",e,"suggestion","No suggestions available at the moment."),!l.trim()&&h("Your Connections",s,"connection","You have not connected with anyone yet.")]})};export{ee as default};
//# sourceMappingURL=NetworkPage-BDDQ82oa.js.map
