import{i as v,b as l,e as h,av as k,aw as N,ax as R,ay as j,P as m}from"./vendor-DRkyCWVM.js";import{d as w}from"./index-LCuuRmLq.js";import"react";const J=async(r={})=>{var a,t;try{const e=r.page||1,i=r.page_size||10,n={...r,page:e,page_size:i};Object.keys(n).forEach(s=>(n[s]===void 0||n[s]==="")&&delete n[s]);const o=await w.get("/jobs/",{params:n,_fullResponse:!0});return{data:o.data,headers:o.headers,status:o.status}}catch(e){if(console.error("Error fetching jobs:",e),e.response){console.error("Response data:",e.response.data),console.error("Response status:",e.response.status),console.error("Response headers:",e.response.headers);const i=((a=e.response.data)==null?void 0:a.detail)||((t=e.response.data)==null?void 0:t.message)||"Failed to fetch jobs",n=new Error(i);throw n.response=e.response,n}else throw e.request?(console.error("No response received:",e.request),new Error("No response received from the server. Please check your network connection.")):(console.error("Request setup error:",e.message),new Error(`Request failed: ${e.message}`))}},$=async r=>{var a,t;if(!r)throw new Error("Job ID is required");try{return(await w.get(`/jobs/${r}/`)).data}catch(e){if(console.error(`Error fetching job ${r}:`,e),e.response){if(e.response.status===404)throw new Error(`Job with ID ${r} not found`);const i=((a=e.response.data)==null?void 0:a.detail)||((t=e.response.data)==null?void 0:t.message)||`Failed to fetch job ${r}`,n=new Error(i);throw n.response=e.response,n}throw e}},E=r=>{const a={count:0,next:null,previous:null,totalPages:1,currentPage:1};try{if(r["x-pagination"]){const t=JSON.parse(r["x-pagination"]);return{count:t.count||0,next:t.next||null,previous:t.previous||null,totalPages:t.total_pages||1,currentPage:t.current_page||1}}}catch(t){console.error("Error parsing pagination:",t)}return a},_=v((r,a)=>({jobs:[],currentJob:null,isLoading:!1,error:null,pagination:{count:0,next:null,previous:null,totalPages:1,currentPage:1},get currentPage(){return a().pagination.currentPage},get totalPages(){return a().pagination.totalPages},get totalCount(){return a().pagination.count},fetchJobs:async(t={})=>{var e,i,n,o;r({isLoading:!0,error:null});try{const s=await J(t),d=E(s.headers);return r({jobs:s.data.results||s.data,pagination:{...d,count:s.data.count||s.data.length||0,next:s.data.next||null,previous:s.data.previous||null,totalPages:Math.ceil((s.data.count||s.data.length||0)/(t.page_size||10)),currentPage:parseInt(t.page||1,10)},isLoading:!1}),s.data.results||s.data}catch(s){const d=((i=(e=s.response)==null?void 0:e.data)==null?void 0:i.detail)||((o=(n=s.response)==null?void 0:n.data)==null?void 0:o.message)||"Failed to fetch jobs";throw r({error:d,isLoading:!1}),new Error(d)}},fetchJobById:async t=>{var e,i,n;if(((e=a().currentJob)==null?void 0:e.id)===t)return a().currentJob;r({isLoading:!0,error:null});try{const o=await $(t);return r({currentJob:o,isLoading:!1}),o}catch(o){const s=((n=(i=o.response)==null?void 0:i.data)==null?void 0:n.detail)||`Failed to fetch job ${t}`;throw r({error:s,isLoading:!1}),new Error(s)}},setCurrentJob:t=>r({currentJob:t}),clear:()=>{r({jobs:[],currentJob:null,error:null,pagination:{count:0,next:null,previous:null,totalPages:1,currentPage:1}})},createJob:async t=>{r({isLoading:!0,error:null});try{const e=await fetch("/api/v1/jobs/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`},body:JSON.stringify(t)});if(!e.ok){const n=await e.json();throw new Error(n.detail||"Failed to create job")}const i=await e.json();return r(n=>({jobs:[i,...n.jobs],isLoading:!1})),i}catch(e){throw console.error("Error creating job:",e),r({error:e.message,isLoading:!1}),e}}})),L=({currentPage:r,totalPages:a,pageNeighbours:t=2,onPageChange:e,className:i="",...n})=>{if(a<=1)return null;const o=(c,u)=>Array.from({length:u-c+1},(g,p)=>c+p),d=(()=>{const c=t*2+3;if(a<=c)return o(1,a);const u=Math.max(2,r-t),g=Math.min(a-1,r+t),p=u>2,x=g<a-1;return!p&&x?[...o(1,3+2*t),"...",a]:p&&!x?[1,"...",...o(a-(3+2*t)+1,a)]:p&&x?[1,"...",...o(u,g),"...",a]:o(1,a)})(),f=r===1,y=r===a;return l("nav",{className:`flex items-center justify-between px-4 sm:px-0 ${i}`,"aria-label":"Pagination",...n,children:h("div",{className:"flex-1 flex justify-between sm:justify-end space-x-2",children:[h("button",{onClick:()=>e(1),disabled:f,className:`relative inline-flex items-center px-2 py-2 rounded-md text-sm font-medium ${f?"text-gray-400 dark:text-gray-600 cursor-not-allowed":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,"aria-label":"First page",children:[l("span",{className:"sr-only",children:"First"}),l(k,{className:"h-5 w-5","aria-hidden":"true"})]}),h("button",{onClick:()=>e(r-1),disabled:f,className:`relative inline-flex items-center px-2 py-2 rounded-md text-sm font-medium ${f?"text-gray-400 dark:text-gray-600 cursor-not-allowed":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,"aria-label":"Previous",children:[l("span",{className:"sr-only",children:"Previous"}),l(N,{className:"h-5 w-5","aria-hidden":"true"})]}),l("div",{className:"hidden sm:flex space-x-1",children:d.map((c,u)=>{if(c==="...")return l("span",{className:"relative inline-flex items-center px-4 py-2 text-sm font-medium text-gray-500",children:"..."},`ellipsis-${u}`);const g=c===r;return l("button",{onClick:()=>e(c),className:`relative inline-flex items-center px-4 py-2 text-sm font-medium ${g?"bg-indigo-600 text-white dark:bg-indigo-700":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"} rounded-md`,"aria-current":g?"page":void 0,children:c},c)})}),h("button",{onClick:()=>e(r+1),disabled:y,className:`relative inline-flex items-center px-2 py-2 rounded-md text-sm font-medium ${y?"text-gray-400 dark:text-gray-600 cursor-not-allowed":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,"aria-label":"Next",children:[l("span",{className:"sr-only",children:"Next"}),l(R,{className:"h-5 w-5","aria-hidden":"true"})]}),h("button",{onClick:()=>e(a),disabled:y,className:`relative inline-flex items-center px-2 py-2 rounded-md text-sm font-medium ${y?"text-gray-400 dark:text-gray-600 cursor-not-allowed":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,"aria-label":"Last page",children:[l("span",{className:"sr-only",children:"Last"}),l(j,{className:"h-5 w-5","aria-hidden":"true"})]})]})})};L.propTypes={currentPage:m.number.isRequired,totalPages:m.number.isRequired,pageNeighbours:m.number,onPageChange:m.func.isRequired,className:m.string};export{L as P,_ as u};
//# sourceMappingURL=Pagination-DEQrYdbP.js.map
