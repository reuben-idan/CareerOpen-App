import{i as P,G as M,e as l,b as s,K as S,U as j,Z as $,_ as D,p as z,h as O,$ as U}from"./vendor-DRkyCWVM.js";import{useState as A,useEffect as y}from"react";import{d as h,e as Y,L as m}from"./index-LCuuRmLq.js";import{E as K}from"./ErrorMessage-BqraKFFY.js";import"react-dom";const Q=async(t={})=>{var a,e;try{const r=t.page||1,n=t.page_size||10,i={...t,page:r,page_size:n};Object.keys(i).forEach(g=>(i[g]===void 0||i[g]==="")&&delete i[g]);const u=await h.get("/network/",{params:i,_fullResponse:!0});return{data:u.data,headers:u.headers,status:u.status}}catch(r){if(console.error("Error fetching network data:",r),r.response){const n=((a=r.response.data)==null?void 0:a.detail)||((e=r.response.data)==null?void 0:e.message)||"Failed to fetch network data",i=new Error(n);throw i.response=r.response,i}else throw r.request?new Error("No response received from the server. Please check your network connection."):new Error(`Request failed: ${r.message}`)}},T=async t=>{var a;if(!t)throw new Error("User ID is required to send a connection request");try{return(await h.post("/network/connections/request/",{user_id:t})).data}catch(e){if(console.error("Error sending connection request:",e),e.response){const r=((a=e.response.data)==null?void 0:a.detail)||Object.values(e.response.data||{}).flat().join(`
`)||"Failed to send connection request",n=new Error(r);throw n.response=e.response,n}throw e}},G=async t=>{var a;if(!t)throw new Error("Request ID is required to accept a connection");try{return(await h.post(`/network/connections/${t}/accept/`)).data}catch(e){if(console.error("Error accepting connection request:",e),e.response){const r=((a=e.response.data)==null?void 0:a.detail)||Object.values(e.response.data||{}).flat().join(`
`)||"Failed to accept connection request",n=new Error(r);throw n.response=e.response,n}throw e}},J=async t=>{var a;if(!t)throw new Error("Request ID is required to decline a connection");try{return(await h.post(`/network/connections/${t}/decline/`)).data}catch(e){if(console.error("Error declining connection request:",e),e.response){const r=((a=e.response.data)==null?void 0:a.detail)||Object.values(e.response.data||{}).flat().join(`
`)||"Failed to decline connection request",n=new Error(r);throw n.response=e.response,n}throw e}},Z=async t=>{var a;if(!t)throw new Error("Connection ID is required to remove a connection");try{return(await h.delete(`/network/connections/${t}/`)).data}catch(e){if(console.error("Error removing connection:",e),e.response){const r=((a=e.response.data)==null?void 0:a.detail)||Object.values(e.response.data||{}).flat().join(`
`)||"Failed to remove connection",n=new Error(r);throw n.response=e.response,n}throw e}},B=async(t,a={})=>{var e;if(!t)throw new Error("Search query is required");try{return(await h.get("/network/search/",{params:{q:t,...a}})).data}catch(r){if(console.error("Error searching users:",r),r.response){const n=((e=r.response.data)==null?void 0:e.detail)||"Failed to search users",i=new Error(n);throw i.response=r.response,i}throw r}},H=t=>{const a={count:0,next:null,previous:null,totalPages:1,currentPage:1};try{if(t["x-pagination"]){const e=JSON.parse(t["x-pagination"]);return{count:e.count||0,next:e.next||null,previous:e.previous||null,totalPages:e.total_pages||1,currentPage:e.current_page||1}}}catch(e){console.error("Error parsing pagination:",e)}return a},V=P((t,a)=>({connections:[],pendingRequests:[],suggestions:[],searchResults:[],isLoading:!1,isSearching:!1,error:null,pagination:{count:0,next:null,previous:null,totalPages:1,currentPage:1},get currentPage(){return a().pagination.currentPage},get totalPages(){return a().pagination.totalPages},get totalCount(){return a().pagination.count},fetchNetworkData:async(e={})=>{t({isLoading:!0,error:null});try{const r=await Q(e),n=H(r.headers),{connections:i=[],pending_requests:u=[],suggestions:g=[]}=r.data;return t({connections:i,pendingRequests:u,suggestions:g,pagination:{...n,count:r.data.count||i.length,totalPages:Math.ceil((r.data.count||i.length)/(e.page_size||10)),currentPage:parseInt(e.page||1,10)},isLoading:!1}),r.data}catch(r){const n=r.message||"Failed to fetch network data";throw t({error:n,isLoading:!1}),r}},searchUsers:async(e,r={})=>{if(!e)return t({searchResults:[],isSearching:!1}),[];t({isSearching:!0,error:null});try{const n=await B(e,r);return t({searchResults:n,isSearching:!1}),n}catch(n){const i=n.message||"Failed to search users";throw t({error:i,isSearching:!1,searchResults:[]}),n}},sendConnectionRequest:async e=>{t({isLoading:!0,error:null});try{const r=await T(e);return t(n=>({suggestions:n.suggestions.filter(i=>i.id!==e),isLoading:!1})),r}catch(r){const n=r.message||"Failed to send connection request";throw t({error:n,isLoading:!1}),r}},acceptConnectionRequest:async e=>{t({isLoading:!0,error:null});try{const r=await G(e);return t(n=>({pendingRequests:n.pendingRequests.filter(i=>i.id!==e),connections:[...n.connections,r],isLoading:!1})),r}catch(r){const n=r.message||"Failed to accept connection request";throw t({error:n,isLoading:!1}),r}},declineConnectionRequest:async e=>{t({isLoading:!0,error:null});try{return await J(e),t(r=>({pendingRequests:r.pendingRequests.filter(n=>n.id!==e),isLoading:!1})),!0}catch(r){const n=r.message||"Failed to decline connection request";throw t({error:n,isLoading:!1}),r}},removeConnection:async e=>{t({isLoading:!0,error:null});try{return await Z(e),t(r=>({connections:r.connections.filter(n=>n.id!==e),isLoading:!1})),!0}catch(r){const n=r.message||"Failed to remove connection";throw t({error:n,isLoading:!1}),r}},clear:()=>t({connections:[],pendingRequests:[],suggestions:[],searchResults:[],error:null,pagination:{count:0,next:null,previous:null,totalPages:1,currentPage:1}})})),ne=()=>{M(),Y();const{connections:t,pendingRequests:a,suggestions:e,searchResults:r,isLoading:n,isSearching:i,error:u,fetchNetworkData:g,searchUsers:f,sendConnectionRequest:x,acceptConnectionRequest:v,declineConnectionRequest:b,removeConnection:N}=V(),[d,k]=A("");y(()=>{g()},[g]),y(()=>{const o=setTimeout(()=>{d.trim()&&f(d)},500);return()=>clearTimeout(o)},[d,f]);const q=async o=>{try{await x(o)}catch(c){console.error("Failed to send connection request:",c)}},R=async o=>{try{await v(o)}catch(c){console.error("Failed to accept connection request:",c)}},E=async o=>{try{await b(o)}catch(c){console.error("Failed to decline connection request:",c)}},C=async o=>{if(window.confirm("Are you sure you want to remove this connection?"))try{await N(o)}catch(c){console.error("Failed to remove connection:",c)}},w=(o,c="suggestion")=>l("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 flex items-center justify-between hover:shadow-md transition-shadow",children:[l("div",{className:"flex items-center space-x-4",children:[s("div",{className:"flex-shrink-0",children:s("div",{className:"h-12 w-12 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center overflow-hidden",children:o.profile_picture?s("img",{src:o.profile_picture,alt:`${o.first_name} ${o.last_name}`,className:"h-full w-full object-cover"}):s(j,{className:"h-6 w-6 text-gray-400"})})}),l("div",{children:[l("h3",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[o.first_name," ",o.last_name]}),o.headline&&s("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate max-w-xs",children:o.headline}),o.mutual_connections>0&&l("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[o.mutual_connections," mutual connection",o.mutual_connections!==1?"s":""]})]})]}),l("div",{className:"flex space-x-2",children:[c==="suggestion"&&l("button",{onClick:()=>q(o.id),className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[s($,{className:"h-4 w-4 mr-1"}),"Connect"]}),c==="pending"&&l(D,{children:[s("button",{onClick:()=>R(o.request_id||o.id),className:"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",title:"Accept",children:s(z,{className:"h-4 w-4"})}),s("button",{onClick:()=>E(o.request_id||o.id),className:"inline-flex items-center px-2 py-1 border border-gray-300 dark:border-gray-600 text-xs font-medium rounded-md text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",title:"Decline",children:s(O,{className:"h-4 w-4"})})]}),c==="connection"&&l("button",{onClick:()=>C(o.connection_id||o.id),className:"inline-flex items-center px-3 py-1.5 border border-gray-300 dark:border-gray-600 text-xs font-medium rounded-md text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",title:"Remove connection",children:[s(U,{className:"h-4 w-4 mr-1"}),"Remove"]})]})]},o.id),p=(o,c,F,_="No items to display")=>l("div",{className:"mb-8",children:[s("h2",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:o}),n&&c.length===0?s("div",{className:"flex justify-center py-8",children:s(m,{size:"md"})}):u&&c.length===0?s(K,{message:u,onRetry:g}):c.length>0?s("div",{className:"grid grid-cols-1 gap-4",children:c.map(L=>w(L,F))}):s("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:_})]});return l("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[l("div",{className:"mb-8",children:[s("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"My Network"}),s("p",{className:"text-gray-600 dark:text-gray-300",children:"Manage your connections and grow your professional network"})]}),s("div",{className:"mb-8",children:l("div",{className:"relative",children:[s("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s(S,{className:"h-5 w-5 text-gray-400"})}),s("input",{type:"text",placeholder:"Search for people to connect with...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md leading-5 bg-white dark:bg-gray-800 placeholder-gray-500 dark:placeholder-gray-400 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",value:d,onChange:o=>k(o.target.value)}),i&&s("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:s(m,{size:"sm"})})]})}),d.trim()&&l("div",{className:"mb-8",children:[l("h2",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:['Search Results for "',d,'"']}),i&&r.length===0?s("div",{className:"flex justify-center py-8",children:s(m,{size:"md"})}):r.length>0?s("div",{className:"grid grid-cols-1 gap-4",children:r.map(o=>w(o,"suggestion"))}):d.trim()?l("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:['No users found matching "',d,'"']}):null]}),!d.trim()&&p("Connection Requests",a,"pending","You have no pending connection requests."),!d.trim()&&p("People You May Know",e,"suggestion","No suggestions available at the moment."),!d.trim()&&p("Your Connections",t,"connection","You have not connected with anyone yet.")]})};export{ne as default};
//# sourceMappingURL=NetworkPage-C_GOhhjl.js.map
