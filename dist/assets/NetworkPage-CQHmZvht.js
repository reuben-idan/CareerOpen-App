import{h as e,i as t,k as n,j as r,a as o,L as s,l as a,m as i,e as c}from"./index-C0ISbAl6.js";import{r as l}from"./react-vendor-Blpmel2Z.js";import{E as d}from"./ErrorMessage-CDRXKEvN.js";import{c as u}from"./router-wWB8CCN9.js";import{F as g}from"./MagnifyingGlassIcon-U1x5WafG.js";import{F as h}from"./UserGroupIcon-DwmoUpI7.js";import{F as m}from"./UserPlusIcon-D1VRgE0K.js";import"./utils-CE5H4mLI.js";import"./ui-components-Cj_Nz0sg.js";function p({title:e,titleId:t,...n},r){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?l.createElement("title",{id:t},e):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M22 10.5h-6m-2.25-4.125a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0ZM4 19.235v-.11a6.375 6.375 0 0 1 12.75 0v.109A12.318 12.318 0 0 1 10.374 21c-2.331 0-4.512-.645-6.374-1.766Z"}))}const f=l.forwardRef(p),w=t((t,n)=>({connections:[],pendingRequests:[],suggestions:[],searchResults:[],isLoading:!1,isSearching:!1,error:null,pagination:{count:0,next:null,previous:null,totalPages:1,currentPage:1},get currentPage(){return n().pagination.currentPage},get totalPages(){return n().pagination.totalPages},get totalCount(){return n().pagination.count},fetchNetworkData:async(n={})=>{t({isLoading:!0,error:null});try{const r=await(async(t={})=>{var n,r;try{const n=t.page||1,r=t.page_size||10,o={...t,page:n,page_size:r};Object.keys(o).forEach(e=>(void 0===o[e]||""===o[e])&&delete o[e]);const s=await e.get("/network/",{params:o,_fullResponse:!0});return{data:s.data,headers:s.headers,status:s.status}}catch(o){if(console.error("Error fetching network data:",o),o.response){const e=(null==(n=o.response.data)?void 0:n.detail)||(null==(r=o.response.data)?void 0:r.message)||"Failed to fetch network data",t=new Error(e);throw t.response=o.response,t}throw o.request?new Error("No response received from the server. Please check your network connection."):new Error(`Request failed: ${o.message}`)}})(n),o=(e=>{try{if(e["x-pagination"]){const t=JSON.parse(e["x-pagination"]);return{count:t.count||0,next:t.next||null,previous:t.previous||null,totalPages:t.total_pages||1,currentPage:t.current_page||1}}}catch(t){console.error("Error parsing pagination:",t)}return{count:0,next:null,previous:null,totalPages:1,currentPage:1}})(r.headers),{connections:s=[],pending_requests:a=[],suggestions:i=[]}=r.data;return t({connections:s,pendingRequests:a,suggestions:i,pagination:{...o,count:r.data.count||s.length,totalPages:Math.ceil((r.data.count||s.length)/(n.page_size||10)),currentPage:parseInt(n.page||1,10)},isLoading:!1}),r.data}catch(r){const e=r.message||"Failed to fetch network data";throw t({error:e,isLoading:!1}),r}},searchUsers:async(n,r={})=>{if(!n)return t({searchResults:[],isSearching:!1}),[];t({isSearching:!0,error:null});try{const o=await(async(t,n={})=>{var r;if(!t)throw new Error("Search query is required");try{return(await e.get("/network/search/",{params:{q:t,...n}})).data}catch(o){if(console.error("Error searching users:",o),o.response){const e=(null==(r=o.response.data)?void 0:r.detail)||"Failed to search users",t=new Error(e);throw t.response=o.response,t}throw o}})(n,r);return t({searchResults:o,isSearching:!1}),o}catch(o){const e=o.message||"Failed to search users";throw t({error:e,isSearching:!1,searchResults:[]}),o}},sendConnectionRequest:async n=>{t({isLoading:!0,error:null});try{const r=await(async t=>{var n;if(!t)throw new Error("User ID is required to send a connection request");try{return(await e.post("/network/connections/request/",{user_id:t})).data}catch(r){if(console.error("Error sending connection request:",r),r.response){const e=(null==(n=r.response.data)?void 0:n.detail)||Object.values(r.response.data||{}).flat().join("\n")||"Failed to send connection request",t=new Error(e);throw t.response=r.response,t}throw r}})(n);return t(e=>({suggestions:e.suggestions.filter(e=>e.id!==n),isLoading:!1})),r}catch(r){const e=r.message||"Failed to send connection request";throw t({error:e,isLoading:!1}),r}},acceptConnectionRequest:async n=>{t({isLoading:!0,error:null});try{const r=await(async t=>{var n;if(!t)throw new Error("Request ID is required to accept a connection");try{return(await e.post(`/network/connections/${t}/accept/`)).data}catch(r){if(console.error("Error accepting connection request:",r),r.response){const e=(null==(n=r.response.data)?void 0:n.detail)||Object.values(r.response.data||{}).flat().join("\n")||"Failed to accept connection request",t=new Error(e);throw t.response=r.response,t}throw r}})(n);return t(e=>({pendingRequests:e.pendingRequests.filter(e=>e.id!==n),connections:[...e.connections,r],isLoading:!1})),r}catch(r){const e=r.message||"Failed to accept connection request";throw t({error:e,isLoading:!1}),r}},declineConnectionRequest:async n=>{t({isLoading:!0,error:null});try{return await(async t=>{var n;if(!t)throw new Error("Request ID is required to decline a connection");try{return(await e.post(`/network/connections/${t}/decline/`)).data}catch(r){if(console.error("Error declining connection request:",r),r.response){const e=(null==(n=r.response.data)?void 0:n.detail)||Object.values(r.response.data||{}).flat().join("\n")||"Failed to decline connection request",t=new Error(e);throw t.response=r.response,t}throw r}})(n),t(e=>({pendingRequests:e.pendingRequests.filter(e=>e.id!==n),isLoading:!1})),!0}catch(r){const e=r.message||"Failed to decline connection request";throw t({error:e,isLoading:!1}),r}},removeConnection:async n=>{t({isLoading:!0,error:null});try{return await(async t=>{var n;if(!t)throw new Error("Connection ID is required to remove a connection");try{return(await e.delete(`/network/connections/${t}/`)).data}catch(r){if(console.error("Error removing connection:",r),r.response){const e=(null==(n=r.response.data)?void 0:n.detail)||Object.values(r.response.data||{}).flat().join("\n")||"Failed to remove connection",t=new Error(e);throw t.response=r.response,t}throw r}})(n),t(e=>({connections:e.connections.filter(e=>e.id!==n),isLoading:!1})),!0}catch(r){const e=r.message||"Failed to remove connection";throw t({error:e,isLoading:!1}),r}},clear:()=>t({connections:[],pendingRequests:[],suggestions:[],searchResults:[],error:null,pagination:{count:0,next:null,previous:null,totalPages:1,currentPage:1}})})),y=()=>{u(),n();const{connections:e,pendingRequests:t,suggestions:p,searchResults:y,isLoading:x,isSearching:v,error:b,fetchNetworkData:k,searchUsers:N,sendConnectionRequest:q,acceptConnectionRequest:R,declineConnectionRequest:E,removeConnection:j}=w(),[L,_]=l.useState("");l.useEffect(()=>{k()},[k]),l.useEffect(()=>{const e=setTimeout(()=>{L.trim()&&N(L)},500);return()=>clearTimeout(e)},[L,N]);const C=(e,t="suggestion")=>r("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 flex items-center justify-between hover:shadow-md transition-shadow",children:[r("div",{className:"flex items-center space-x-4",children:[o("div",{className:"flex-shrink-0",children:o("div",{className:"h-12 w-12 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center overflow-hidden",children:e.profile_picture?o("img",{src:e.profile_picture,alt:`${e.first_name} ${e.last_name}`,className:"h-full w-full object-cover"}):o(h,{className:"h-6 w-6 text-gray-400"})})}),r("div",{children:[r("h3",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[e.first_name," ",e.last_name]}),e.headline&&o("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate max-w-xs",children:e.headline}),e.mutual_connections>0&&r("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[e.mutual_connections," mutual connection",1!==e.mutual_connections?"s":""]})]})]}),r("div",{className:"flex space-x-2",children:["suggestion"===t&&r("button",{onClick:()=>(async e=>{try{await q(e)}catch(t){console.error("Failed to send connection request:",t)}})(e.id),className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[o(m,{className:"h-4 w-4 mr-1"}),"Connect"]}),"pending"===t&&r(a,{children:[o("button",{onClick:()=>(async e=>{try{await R(e)}catch(t){console.error("Failed to accept connection request:",t)}})(e.request_id||e.id),className:"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",title:"Accept",children:o(i,{className:"h-4 w-4"})}),o("button",{onClick:()=>(async e=>{try{await E(e)}catch(t){console.error("Failed to decline connection request:",t)}})(e.request_id||e.id),className:"inline-flex items-center px-2 py-1 border border-gray-300 dark:border-gray-600 text-xs font-medium rounded-md text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",title:"Decline",children:o(c,{className:"h-4 w-4"})})]}),"connection"===t&&r("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to remove this connection?"))try{await j(e)}catch(t){console.error("Failed to remove connection:",t)}})(e.connection_id||e.id),className:"inline-flex items-center px-3 py-1.5 border border-gray-300 dark:border-gray-600 text-xs font-medium rounded-md text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",title:"Remove connection",children:[o(f,{className:"h-4 w-4 mr-1"}),"Remove"]})]})]},e.id),F=(e,t,n,a="No items to display")=>r("div",{className:"mb-8",children:[o("h2",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:e}),x&&0===t.length?o("div",{className:"flex justify-center py-8",children:o(s,{size:"md"})}):b&&0===t.length?o(d,{message:b,onRetry:k}):t.length>0?o("div",{className:"grid grid-cols-1 gap-4",children:t.map(e=>C(e,n))}):o("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:a})]});return r("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[r("div",{className:"mb-8",children:[o("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"My Network"}),o("p",{className:"text-gray-600 dark:text-gray-300",children:"Manage your connections and grow your professional network"})]}),o("div",{className:"mb-8",children:r("div",{className:"relative",children:[o("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o(g,{className:"h-5 w-5 text-gray-400"})}),o("input",{type:"text",placeholder:"Search for people to connect with...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md leading-5 bg-white dark:bg-gray-800 placeholder-gray-500 dark:placeholder-gray-400 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",value:L,onChange:e=>_(e.target.value)}),v&&o("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:o(s,{size:"sm"})})]})}),L.trim()&&r("div",{className:"mb-8",children:[r("h2",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:['Search Results for "',L,'"']}),v&&0===y.length?o("div",{className:"flex justify-center py-8",children:o(s,{size:"md"})}):y.length>0?o("div",{className:"grid grid-cols-1 gap-4",children:y.map(e=>C(e,"suggestion"))}):L.trim()?r("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:['No users found matching "',L,'"']}):null]}),!L.trim()&&F("Connection Requests",t,"pending","You have no pending connection requests."),!L.trim()&&F("People You May Know",p,"suggestion","No suggestions available at the moment."),!L.trim()&&F("Your Connections",e,"connection","You have not connected with anyone yet.")]})};export{y as default};
//# sourceMappingURL=NetworkPage-CQHmZvht.js.map
